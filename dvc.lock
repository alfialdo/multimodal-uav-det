schema: '2.0'
stages:
  prepare_dataloader:
    cmd: python prepare_dataloader.py
    deps:
    - path: prepare_dataloader.py
      hash: md5
      md5: d7a8a6b6438f3af55f84fdc7d37aa0d8
      size: 2184
    params:
      params.yaml:
        dataset:
          root_dir: /home/aldo/opt/dataset/Anti-UAV-RGBT
          train_loader_path: data/train_dataloader.pickle
          val_loader_path: data/val_dataloader.pickle
          train_batch_size: 8
          val_batch_size: 8
          remote: false
          image_size:
          - 640
          - 640
          workers: 16
          mosaic: false
    outs:
    - path: data/train_dataloader.pickle
      hash: md5
      md5: 370bb005be9b9f838276dbfd3e92a473
      size: 139796676
    - path: data/val_dataloader.pickle
      hash: md5
      md5: f2796d0d899cbadece8b7e79e089b3eb
      size: 56770473
  train:
    cmd: python train.py
    deps:
    - path: data/train_dataloader.pickle
      hash: md5
      md5: 370bb005be9b9f838276dbfd3e92a473
      size: 139796676
    - path: data/val_dataloader.pickle
      hash: md5
      md5: f2796d0d899cbadece8b7e79e089b3eb
      size: 56770473
    - path: train.py
      hash: md5
      md5: 55ccda007d9a910f6a418b07f4ae966a
      size: 2197
    params:
      params.yaml:
        dataset:
          root_dir: /home/aldo/opt/dataset/Anti-UAV-RGBT
          train_loader_path: data/train_dataloader.pickle
          val_loader_path: data/val_dataloader.pickle
          train_batch_size: 8
          val_batch_size: 8
          remote: false
          image_size:
          - 640
          - 640
          workers: 16
          mosaic: false
        train:
          seed: 11
          model: proposed
          hparams:
            anchors:
            - - - 29
                - 23
              - - 48
                - 30
              - - 67
                - 38
            - - - 91
                - 54
              - - 120
                - 75
              - - 157
                - 60
            - - - 199
                - 73
              - - 315
                - 92
              - - 268
                - 182
            head_scales:
            - 2
            - 4
            - 8
            lr: 0.001
            attention_temperature: 30
            optim: Adam
            num_dy_conv:
            - 3
            - 3
            - 3
            dy_kernel_size:
            - 3
            - 3
            - 3
            loss_balancing:
              obj_scales_w:
              - 2.0
              - 1.0
              - 0.5
              bbox_w: 4.0
              objectness_w: 1.0
          trainer:
            epochs: 2
            input_size:
            - 3
            - 640
            - 640
            profiler:
            grad_batches: 4
            train_batches: 1.0
            val_batches: 0.25
            val_check_interval: 4000
            accelerator: gpu
            devices: 1
            precision: high
          checkpoint:
            dir: logs/checkpoints
            monitor: val_loss
            mode: min
    outs:
    - path: dvclive/plots
      hash: md5
      md5: ea6f8fffb5ed3873317418cb6bb4f9b0.dir
      size: 12053
      nfiles: 3
    - path: logs/checkpoints
      hash: md5
      md5: efa97c6487dbe7e070d680d05f3ca6d1.dir
      size: 134467860
      nfiles: 2
