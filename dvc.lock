schema: '2.0'
stages:
  prepare_dataloader:
    cmd: python prepare_dataloader.py
    deps:
    - path: prepare_dataloader.py
      hash: md5
      md5: b53f24089f72994b008dcc4f1b6d93c1
      size: 1890
    params:
      params.yaml:
        dataset:
          root_dir: /home/aldo/opt/dataset/Anti-UAV-RGBT
          train_loader_path: data/train_dataloader.pickle
          val_loader_path: data/val_dataloader.pickle
          test_loader_path: data/test_dataloader.pickle
          batch_size: 4
          remote: false
          image_size:
          - 640
          - 640
          workers: 32
          mosaic: false
          format: yolo
        model.hparams.anchors:
        - - - 199
            - 73
          - - 315
            - 92
          - - 268
            - 182
        - - - 91
            - 54
          - - 120
            - 75
          - - 157
            - 60
        - - - 29
            - 23
          - - 48
            - 30
          - - 67
            - 38
        model.hparams.head_scales:
        - 32
        - 16
        - 8
        train.seed: 211
    outs:
    - path: data/test_dataloader.pickle
      hash: md5
      md5: 95f2c42aa27ffd9deeb46f25c752c927
      size: 80057695
    - path: data/train_dataloader.pickle
      hash: md5
      md5: f42fb78c463e37e6c52168371b0b98d4
      size: 142369636
    - path: data/val_dataloader.pickle
      hash: md5
      md5: dd12afad6ae4f07935d510e79750ee09
      size: 57854731
  train:
    cmd: python train.py
    deps:
    - path: data/train_dataloader.pickle
      hash: md5
      md5: f42fb78c463e37e6c52168371b0b98d4
      size: 142369636
    - path: data/val_dataloader.pickle
      hash: md5
      md5: dd12afad6ae4f07935d510e79750ee09
      size: 57854731
    - path: train.py
      hash: md5
      md5: 8b4db422136faab5b308ec966f058ec3
      size: 2424
    params:
      params.yaml:
        dataset:
          root_dir: /home/aldo/opt/dataset/Anti-UAV-RGBT
          train_loader_path: data/train_dataloader.pickle
          val_loader_path: data/val_dataloader.pickle
          test_loader_path: data/test_dataloader.pickle
          batch_size: 4
          remote: false
          image_size:
          - 640
          - 640
          workers: 32
          mosaic: false
          format: yolo
        model:
          name: DyYOLO
          hparams:
            anchors:
            - - - 199
                - 73
              - - 315
                - 92
              - - 268
                - 182
            - - - 91
                - 54
              - - 120
                - 75
              - - 157
                - 60
            - - - 29
                - 23
              - - 48
                - 30
              - - 67
                - 38
            head_scales:
            - 32
            - 16
            - 8
            lr: 0.0001
            lr_scheduler: false
            loss_balancing:
              obj_scales_w:
              - 0.5
              - 1.0
              - 2.0
              bbox_w: 4.0
              objectness_w: 1.0
              no_obj_w: 4.0
            bbox_loss_fn: mse
            attn_temperature: 30.0
            optim:
              name: SGD
              momentum: 0.78
            layer_config:
            - - DyConv
              - 32
              - 3
              - 1
            - - DyConv
              - 64
              - 3
              - 2
            - - B
              - 1
            - - 128
              - 3
              - 2
            - - B
              - 2
            - - 256
              - 3
              - 2
            - - B
              - 8
            - - 512
              - 3
              - 2
            - - B
              - 8
            - - 1024
              - 3
              - 2
            - - B
              - 4
            - - DyConv
              - 512
              - 1
              - 1
            - - 1024
              - 3
              - 1
            - - S
            - - 256
              - 1
              - 1
            - - U
            - - DyConv
              - 256
              - 1
              - 1
            - - 512
              - 3
              - 1
            - - S
            - - 128
              - 1
              - 1
            - - U
            - - DyConv
              - 128
              - 1
              - 1
            - - 256
              - 3
              - 1
            - - S
        train:
          seed: 211
          trainer:
            epochs: 2
            input_size:
            - 3
            - 640
            - 640
            profiler:
            grad_batches: 2
            train_batches: 1.0
            val_batches: 1.0
            val_check_interval: 1.0
            accelerator: gpu
            devices: 1
            precision: 16
            grad_clip_val:
          checkpoint:
            dir: logs/checkpoints
            monitor: val_loss
            mode: min
    outs:
    - path: dvclive/plots
      hash: md5
      md5: cd9c50c817ca0888e362053be381615a.dir
      size: 119514
      nfiles: 7
    - path: logs/checkpoints
      hash: md5
      md5: 1bcfe7bd99abc788db56ba49ee408dfe.dir
      size: 1030298728
      nfiles: 2
